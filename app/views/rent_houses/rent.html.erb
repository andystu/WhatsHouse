<html>
		<head>
			<script src="https://thecodeplayer.com/uploads/js/jquery.easing.min.js" type="text/javascript"></script>
		</head>
<body>

		<div id = "rent_houses_page">
			
		<%= form_for @rent_house, :html => {:id => "msform"} do |f| %>
		<!-- progressbar -->
		<ul id="progressbar">
			<li class="active"><p>基本資訊</p></li>
			<li><p>聯絡資訊</p></li>
			<li><p>刊登內容</p></li>
		</ul>	
		<fieldset>
		  <%= render 'shared/error_messages', object: f.object%>
		  <div class="field use">
			<div class="ui left labeled icon input">
				<%= f.text_field :use , :placeholder => "類別"%>
			  <i class="home icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
		  </div> 

		  <div class="field structure">
			<div class="ui left labeled icon input">
				<%= f.text_field :structure, :placeholder => "格局"%>
			  <i class="building icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
		  </div>

		  <div class="field">
			<div class="ui left labeled icon input">
				<%= f.text_field :address, :placeholder => "地址"%>
			  <i class="map marker icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
		  </div> 

		  <div class="field price">
			<div class="ui left labeled icon input">
				<%= f.text_field :price, :placeholder => "租金"%>
			  <i class="dollar icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
		  </div> 
			<input type="button" name="next" class="next action-button" value="下一步" />
		  </fieldset>
		 <fieldset>
		  <div class="field">
			<div class="ui left labeled icon input">
				<%= f.text_field :owner, :placeholder => "聯絡人"%>
			  <i class="user icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
		  </div>

		  <div class="field">
			<div class="ui left labeled icon input">
				<%= f.text_field :tel, :placeholder => "聯絡電話"%>
			  <i class="phone icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
		  </div>
		<input type="button" name="previous" class="previous action-button" value="上一步" />
		<input type="button" name="next" class="next action-button" value="下一步" />
		 </fieldset>

		 <fieldset>
		  <div class="field">
			<div class="ui left labeled icon input">
					<%= f.text_area  :breif, :placeholder => "刊登資訊" %>
			  <i class="infor icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
		  </div>

		  <div class="field img_input_wrapper">
			<div class="ui left labeled icon input">
			  <%= text_field_tag 'img[]',  nil, :placeholder => "照片" %>
			  <i class="photo icon"></i>
			  <div class="ui corner label">
				<i class="icon asterisk"></i>
			  </div>
			</div>
			<span class="i icon button add_more_button"><i class="add icon"></i></span>
		  </div>
		<input type="button" name="previous" class="previous action-button" value="上一步" />
		  <%= f.submit "出租", class:"submit action-button" %>
		</fieldset>
		</div>
		<% end %>

		<div class="house_list">
		  <% if @user.rent_houses.any? %>
			<h3>出租中 (<%= @user.rent_houses.count %>)</h3>
			<ol class="rent_houses">
			  <%= render @rent_houses %>
			</ol>
			<%= will_paginate @rent_houses %>
		  <% end %>
		</div>



		<script>
		$(document).ready(function(){

		$('#msform')
		  .form({
			use: {
			  identifier : 'rent_house[use]',
			  rules: [
				{
				  type   : 'empty',
				  prompt : '請輸入類別'
				}
			  ]
			},
			structure: {
			  identifier : 'rent_house[structure]',
			  rules: [
				{
				  type   : 'empty',
				  prompt : '請輸入格局'
				}
			  ]
			},
			address: {
			  identifier : 'rent_house[address]',
			  rules: [
				{
				  type   : 'empty',
				  prompt : '請輸入地址'
				}
			  ]
			},
			price: {
			  identifier : 'rent_house[price]',
			  rules: [
				{
				  type   : 'empty',
				  prompt : '請輸入月租'
				}
			  ]
			},
			owner: {
			  identifier : 'rent_house[owner]',
			  rules: [
				{
				  type   : 'empty',
				  prompt : '請輸入聯絡人'
				}
			  ]
			},
			tel: {
			  identifier : 'rent_house[tel]',
			  rules: [
				{
				  type   : 'empty',
				  prompt : '請輸入聯絡電話'
				}
			  ]
			},
			breif: {
			  identifier : 'rent_house[breif]',
			  rules: [
				{
				  type   : 'empty',
				  prompt : '請輸入刊登資訊'
				}
			  ]
			}
		  },{
			on: 'blur',
			inline: 'true',
			onSuccess : function() {
			}
		  })
		});



		// add input field by jQuery
		var max_input = 5;
		var inputs_wrapper = $('.img_input_wrapper');
		var add_button = $('.add_more_button');

		var x = inputs_wrapper.length;
		var fieldCount = 1;

		$(add_button).click( function(e) 
		{
			if ( x <= max_input ){
				fieldCount++;
				$(inputs_wrapper).append('<div><div class="ui left labeled icon input"> \
										 <input id="rent_house_img" name="img[]" type="text" > \
												<i class="photo icon"></i> \
												<div class="ui corner label"> \
													<i class="icon asterisk"></i> \
												</div> \
										</div> \
										<a href="#" class="removeclass">×</a></div>'
										);
				x++;
			}
			return false;
		});

		$('body').on('click', '.removeclass', function(e){

				if( x > 1 ){
					$(this).parent('div').remove();
					x--;
				}
			return false;
		})


		</script>
	</body>
</html>
